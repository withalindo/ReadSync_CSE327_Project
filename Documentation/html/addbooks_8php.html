<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ReadSync: BackEnd/addbooks.php File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">ReadSync
   </div>
  </td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('addbooks_8php.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">addbooks.php File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>This file handles the backend logic for adding new books to the library system.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ad3b126154bca8dcc714c726ab2780b06" id="r_ad3b126154bca8dcc714c726ab2780b06"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad3b126154bca8dcc714c726ab2780b06">$book_name</a> = mysqli_real_escape_string($conn, $_POST['book_name'])</td></tr>
<tr class="memdesc:ad3b126154bca8dcc714c726ab2780b06"><td class="mdescLeft">&#160;</td><td class="mdescRight">I retrieve and sanitize the book, author, and category details from the form submission.  <br /></td></tr>
<tr class="separator:ad3b126154bca8dcc714c726ab2780b06"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab7769480c9210fb8a58e3692ecdad792" id="r_ab7769480c9210fb8a58e3692ecdad792"><td class="memItemLeft" align="right" valign="top"><a id="ab7769480c9210fb8a58e3692ecdad792" name="ab7769480c9210fb8a58e3692ecdad792"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>$book_isbn</b> = mysqli_real_escape_string($conn, $_POST['book_isbn'])</td></tr>
<tr class="separator:ab7769480c9210fb8a58e3692ecdad792"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2c618c43ebce7a2a8736661bf14d4af" id="r_ac2c618c43ebce7a2a8736661bf14d4af"><td class="memItemLeft" align="right" valign="top"><a id="ac2c618c43ebce7a2a8736661bf14d4af" name="ac2c618c43ebce7a2a8736661bf14d4af"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>$author_id</b> = intval($_POST['author_id'])</td></tr>
<tr class="separator:ac2c618c43ebce7a2a8736661bf14d4af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc1c7aac29d7cc0cc437f39727f29423" id="r_adc1c7aac29d7cc0cc437f39727f29423"><td class="memItemLeft" align="right" valign="top"><a id="adc1c7aac29d7cc0cc437f39727f29423" name="adc1c7aac29d7cc0cc437f39727f29423"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>$author_name</b> = mysqli_real_escape_string($conn, $_POST['author_name'])</td></tr>
<tr class="separator:adc1c7aac29d7cc0cc437f39727f29423"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42710967ceed1111a3043f0aafceaaa9" id="r_a42710967ceed1111a3043f0aafceaaa9"><td class="memItemLeft" align="right" valign="top"><a id="a42710967ceed1111a3043f0aafceaaa9" name="a42710967ceed1111a3043f0aafceaaa9"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>$category_name</b> = mysqli_real_escape_string($conn, $_POST['cat_name'])</td></tr>
<tr class="separator:a42710967ceed1111a3043f0aafceaaa9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae04842fdf110b23f4e74bbccf8870427" id="r_ae04842fdf110b23f4e74bbccf8870427"><td class="memItemLeft" align="right" valign="top"><a id="ae04842fdf110b23f4e74bbccf8870427" name="ae04842fdf110b23f4e74bbccf8870427"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>$cat_id</b> = intval($_POST['cat_id'])</td></tr>
<tr class="separator:ae04842fdf110b23f4e74bbccf8870427"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26ae05c033cdaa9e1b7f798bbe9859d1" id="r_a26ae05c033cdaa9e1b7f798bbe9859d1"><td class="memItemLeft" align="right" valign="top"><a id="a26ae05c033cdaa9e1b7f798bbe9859d1" name="a26ae05c033cdaa9e1b7f798bbe9859d1"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>$no_of_copies</b> = intval($_POST['no_of_copies'])</td></tr>
<tr class="separator:a26ae05c033cdaa9e1b7f798bbe9859d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2caa3b2be3eb23a31a745f8321b50d2" id="r_ae2caa3b2be3eb23a31a745f8321b50d2"><td class="memItemLeft" align="right" valign="top"><a id="ae2caa3b2be3eb23a31a745f8321b50d2" name="ae2caa3b2be3eb23a31a745f8321b50d2"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>$book_price</b> = floatval($_POST['book_price'])</td></tr>
<tr class="separator:ae2caa3b2be3eb23a31a745f8321b50d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b970eb0ea99d5a65a085e96ee542ad8" id="r_a2b970eb0ea99d5a65a085e96ee542ad8"><td class="memItemLeft" align="right" valign="top">if($no_of_copies&lt; 0|| $book_price&lt; 0)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2b970eb0ea99d5a65a085e96ee542ad8">$check_author_query</a> = &quot;SELECT * FROM authors WHERE author_id = $author_id&quot;</td></tr>
<tr class="memdesc:a2b970eb0ea99d5a65a085e96ee542ad8"><td class="mdescLeft">&#160;</td><td class="mdescRight">I validate the number of copies and book price to ensure they are non-negative.  <br /></td></tr>
<tr class="separator:a2b970eb0ea99d5a65a085e96ee542ad8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa81d565440dbe76acc8795b3863c8ce0" id="r_aa81d565440dbe76acc8795b3863c8ce0"><td class="memItemLeft" align="right" valign="top"><a id="aa81d565440dbe76acc8795b3863c8ce0" name="aa81d565440dbe76acc8795b3863c8ce0"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>$check_author_result</b> = mysqli_query($conn, $check_author_query)</td></tr>
<tr class="separator:aa81d565440dbe76acc8795b3863c8ce0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a41fadd88e9dd0816e1d7d020c4a6830f" id="r_a41fadd88e9dd0816e1d7d020c4a6830f"><td class="memItemLeft" align="right" valign="top">if(mysqli_num_rows($check_author_result)==0)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a41fadd88e9dd0816e1d7d020c4a6830f">$check_category_query</a> = &quot;SELECT * FROM categories WHERE category_id = $cat_id AND category_name = '$category_name'&quot;</td></tr>
<tr class="memdesc:a41fadd88e9dd0816e1d7d020c4a6830f"><td class="mdescLeft">&#160;</td><td class="mdescRight">I check if the category exists in the <code>categories</code> table.  <br /></td></tr>
<tr class="separator:a41fadd88e9dd0816e1d7d020c4a6830f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e3c68db882c745566f02df4450ee531" id="r_a5e3c68db882c745566f02df4450ee531"><td class="memItemLeft" align="right" valign="top"><a id="a5e3c68db882c745566f02df4450ee531" name="a5e3c68db882c745566f02df4450ee531"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>$check_category_result</b> = mysqli_query($conn, $check_category_query)</td></tr>
<tr class="separator:a5e3c68db882c745566f02df4450ee531"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a947cf6e606a70b8ea2eae3feb07d221e" id="r_a947cf6e606a70b8ea2eae3feb07d221e"><td class="memItemLeft" align="right" valign="top">if(mysqli_num_rows($check_category_result)==0)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a947cf6e606a70b8ea2eae3feb07d221e">$book_query</a></td></tr>
<tr class="memdesc:a947cf6e606a70b8ea2eae3feb07d221e"><td class="mdescLeft">&#160;</td><td class="mdescRight">I insert the book details into the <code>books</code> table.  <br /></td></tr>
<tr class="separator:a947cf6e606a70b8ea2eae3feb07d221e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada8af174388e4a5bd9304c9628e48d9f" id="r_ada8af174388e4a5bd9304c9628e48d9f"><td class="memItemLeft" align="right" valign="top">if(mysqli_query($conn, $book_query))&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ada8af174388e4a5bd9304c9628e48d9f">else</a></td></tr>
<tr class="separator:ada8af174388e4a5bd9304c9628e48d9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This file handles the backend logic for adding new books to the library system. </p>
<p>I created this file to process form submissions for adding new books. It validates the input, checks for the existence of authors and categories, and inserts the book details into the database.</p>
<ul>
<li>I included the <code><a class="el" href="connect_d_b_8php.html" title="This file establishes a connection to the database.">connectDB.php</a></code> file to establish a connection to the database.</li>
<li>The script retrieves the book details, author details, and category details from the form submission.</li>
<li>I use <code>mysqli_real_escape_string</code> to sanitize the input and prevent SQL injection.</li>
<li>The script checks if the author and category already exist in the database:<ul>
<li>If the author does not exist, I add the author to the <code>authors</code> table.</li>
<li>If the category does not exist, I add the category to the <code>categories</code> table.</li>
</ul>
</li>
<li>After ensuring the author and category exist, I insert the book details into the <code>books</code> table.</li>
<li>If any operation fails, I display an appropriate error message using JavaScript alerts.</li>
<li>Finally, I close the database connection to free up resources.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>Ensure that the database contains the <code>authors</code>, <code>categories</code>, and <code>books</code> tables with the appropriate schema.</li>
<li>This file is intended for use by administrators only.</li>
</ul>
</dd></dl>
<dl class="section author"><dt>Author</dt><dd>withalindo </dd></dl>
<dl class="section date"><dt>Date</dt><dd>April 17, 2025 </dd></dl>
</div><h2 class="groupheader">Variable Documentation</h2>
<a id="ad3b126154bca8dcc714c726ab2780b06" name="ad3b126154bca8dcc714c726ab2780b06"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad3b126154bca8dcc714c726ab2780b06">&#9670;&#160;</a></span>$book_name</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$book_name = mysqli_real_escape_string($conn, $_POST['book_name'])</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>I retrieve and sanitize the book, author, and category details from the form submission. </p>
<p>I use <code>mysqli_real_escape_string</code> to sanitize the input fields and <code>intval</code> or <code>floatval</code> to ensure numeric values are properly handled. </p>

</div>
</div>
<a id="a947cf6e606a70b8ea2eae3feb07d221e" name="a947cf6e606a70b8ea2eae3feb07d221e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a947cf6e606a70b8ea2eae3feb07d221e">&#9670;&#160;</a></span>$book_query</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">if (mysqli_num_rows( $check_category_result)==0) $book_query</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= <span class="stringliteral">&quot;INSERT INTO books (book_name, book_isbn, author_id, category_id, number_of_copies, book_price) </span></div>
<div class="line"><span class="stringliteral">               VALUES (&#39;$book_name&#39;, &#39;$book_isbn&#39;, $author_id, $cat_id, $no_of_copies, $book_price)&quot;</span></div>
</div><!-- fragment -->
<p>I insert the book details into the <code>books</code> table. </p>
<p>After ensuring the author and category exist, I insert the book details into the <code>books</code> table. If the operation is successful, I display a success message. Otherwise, I display an error message. </p>

</div>
</div>
<a id="a2b970eb0ea99d5a65a085e96ee542ad8" name="a2b970eb0ea99d5a65a085e96ee542ad8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2b970eb0ea99d5a65a085e96ee542ad8">&#9670;&#160;</a></span>$check_author_query</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">if ( $no_of_copies&lt; 0||$book_price&lt; 0) $check_author_query </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> = &quot;SELECT * FROM authors WHERE author_id = $author_id&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>I validate the number of copies and book price to ensure they are non-negative. </p>
<p>If the number of copies or book price is negative, I display an error message and stop execution.</p>
<p>I check if the author exists in the <code>authors</code> table.</p>
<p>If the author does not exist, I insert the author into the <code>authors</code> table. </p>

</div>
</div>
<a id="a41fadd88e9dd0816e1d7d020c4a6830f" name="a41fadd88e9dd0816e1d7d020c4a6830f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a41fadd88e9dd0816e1d7d020c4a6830f">&#9670;&#160;</a></span>$check_category_query</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">if (mysqli_num_rows( $check_author_result)==0) $check_category_query = &quot;SELECT * FROM categories WHERE category_id = $cat_id AND category_name = '$category_name'&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>I check if the category exists in the <code>categories</code> table. </p>
<p>If the category does not exist, I insert the category into the <code>categories</code> table. </p>

</div>
</div>
<a id="ada8af174388e4a5bd9304c9628e48d9f" name="ada8af174388e4a5bd9304c9628e48d9f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ada8af174388e4a5bd9304c9628e48d9f">&#9670;&#160;</a></span>else</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">if (mysqli_query( $conn, $book_query)) else</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">{</div>
<div class="line">    echo <span class="stringliteral">&quot;&lt;script&gt;alert(&#39;Error: Could not add the book.&#39;);&lt;/script&gt;&quot;</span></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_c6279d47f55929b34a73f030d2bfef17.html">BackEnd</a></li><li class="navelem"><a class="el" href="addbooks_8php.html">addbooks.php</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
